plugins {
  id 'java'
  id 'application'
  id 'com.google.cloud.tools.jib' version '1.0.2'
}

mainClassName = 'com.mycompany.app.App'

repositories {
    mavenLocal()
    mavenCentral()
}
dependencies {
    compile "junit:junit:3.8.1"
}
jar {
    baseName = 'gs-gradle'
    version =  '0.1.0'
}


jib {
  allowInsecureRegistries = true
  extraDirectory = file('src/main/custom-extra-dir')
  from {
    image = 'registry.cosmoplat.com/library/openjdk:8-alpine'
  }
  to {
    image = 'registry.cosmoplat.com/test/jib-gradle-demo'
    tags = ['tag2', 'latest']
  }
  container {
    useCurrentTimestamp = true
    appRoot = '/app'
    environment = [JAVA_OPTS:'-Xms512m -Xmx512m']
    jvmFlags = ['-Xdebug']
    mainClass = 'com.mycompany.app.App'
    user = 'root'
    volumes = ['/opt']
    ports = ['1000', '2000-2003/udp']
    args = ['some', 'args']
    labels = [key1:'value1', key2:'value2']
  }
}
